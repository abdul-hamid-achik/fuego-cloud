// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: oauth_states.sql

package db

import (
	"context"
	"time"
)

const createOAuthState = `-- name: CreateOAuthState :one
INSERT INTO oauth_states (state, redirect_uri, cli_token_exchange, expires_at)
VALUES ($1, $2, $3, $4)
RETURNING state, redirect_uri, cli_token_exchange, created_at, expires_at
`

type CreateOAuthStateParams struct {
	State            string    `json:"state"`
	RedirectUri      *string   `json:"redirect_uri"`
	CliTokenExchange *bool     `json:"cli_token_exchange"`
	ExpiresAt        time.Time `json:"expires_at"`
}

func (q *Queries) CreateOAuthState(ctx context.Context, arg CreateOAuthStateParams) (OauthState, error) {
	row := q.db.QueryRow(ctx, createOAuthState,
		arg.State,
		arg.RedirectUri,
		arg.CliTokenExchange,
		arg.ExpiresAt,
	)
	var i OauthState
	err := row.Scan(
		&i.State,
		&i.RedirectUri,
		&i.CliTokenExchange,
		&i.CreatedAt,
		&i.ExpiresAt,
	)
	return i, err
}

const deleteExpiredOAuthStates = `-- name: DeleteExpiredOAuthStates :exec
DELETE FROM oauth_states WHERE expires_at < NOW()
`

func (q *Queries) DeleteExpiredOAuthStates(ctx context.Context) error {
	_, err := q.db.Exec(ctx, deleteExpiredOAuthStates)
	return err
}

const deleteOAuthState = `-- name: DeleteOAuthState :exec
DELETE FROM oauth_states WHERE state = $1
`

func (q *Queries) DeleteOAuthState(ctx context.Context, state string) error {
	_, err := q.db.Exec(ctx, deleteOAuthState, state)
	return err
}

const getOAuthState = `-- name: GetOAuthState :one
SELECT state, redirect_uri, cli_token_exchange, created_at, expires_at FROM oauth_states WHERE state = $1
`

func (q *Queries) GetOAuthState(ctx context.Context, state string) (OauthState, error) {
	row := q.db.QueryRow(ctx, getOAuthState, state)
	var i OauthState
	err := row.Scan(
		&i.State,
		&i.RedirectUri,
		&i.CliTokenExchange,
		&i.CreatedAt,
		&i.ExpiresAt,
	)
	return i, err
}
